<ion-view title="Dashboards" hide-back-button="true" class="page_width_medium_dashboard"  style="background-color:#FFFFFF;">
  <ion-nav-buttons side="right" class="has-header">
   <input type="text" placeholder="Search" ng-model="data.search" style="border: 2px solid grey; border-radius: 5px; padding: 5px"
               ng-keyup="submitSearch($event)" ng-keydown="submitSearch($event)">
    <button class="button button-icon ion-android-add-circle" ng-click="add()"></button>
  </ion-nav-buttons>
  <ion-content padding="true" class="has-header">
    <div ng-show="dashboards.length == 0" style="width: 100%">
      <h4 style="text-align: center;">No dashboards</h4>
    </div>
    <div class="row" ng-show="dashboards.length != 0">
        <div class="col col-33">
            <div class="dashboard-container dashboard-border dashboard-round-border" style="padding: 20px;">
              <h2><strong>Dashboards</strong></h2>
              <br></br>
              <div ng-repeat="dashboard in dashboards">
                 <div class="card row"
                      style="padding-right: 20px;"
                      ng-style="dashboard.id == dashboardDetail.id && {'background-color':'#EEEEEE'} || {'background-color': 'white'}">
                  <div class="col col-20">
                    <button style="font-weight:500; padding-right: 50px;"
                            ng-style="{'color': dashboard.color}"
                            class="button-large button-block button-clear icon ion-ios-analytics">
                    </button>
                  </div>
                  <div class="col" ng-click="viewDetail(dashboard)">
                    <b>{{dashboard.name}}</b>
                    <p>Created: {{dashboard.createdAt}}</p>
                    <p>Modified: {{dashboard.modifiedAt}}</p>
                  </div>
                  <div class="col col-25">
                    <button ng-click="delete(dashboard.id)"
                            style="font-weight:500;"
                            ng-style="{'color': dashboard.color}"
                            class="button button-positive button-large button-clear icon-right ion-android-close">
                    </button>
                  </div>
                </div>
              </div>
            </div>
        </div>

        <!--TAB: Information  -->

        <div class="col col-67">
             <div class="dashboard-container dashboard-border dashboard-round-border">
                <h2><strong>Information</strong></h2>
                <br></br>
                <form>
                  <div class="row">
                    <div ng-repeat="color in colors">
                      <div class="item item-body box-color"
                          ng-if="selectedColor !== color"
                          ng-click="selectColor(color)"
                          ng-style="{'background-color': color}">
                      </div>
                      <div class="item item-body box-color box-selected-color"
                          ng-if="selectedColor === color"
                          ng-click="selectColor(color)"
                          ng-style="{'background-color': color}">
                      </div>
                    </div>
                  </div>
                  <br></br>

                  <label class="item item-input item-floating-label">
                    <span class="input-label">Dashboard Name</span>
                    <input type="text" placeholder="Dashboard Name" ng-model="dashboardDetail.name">
                  </label>
                  <button id="addGateway-button55"
                          ng-click="save()"
                          style="width: 40%;margin: auto; margin-top: 20px"
                          ng-style="{'background-color': selectedColor}"
                          class="button button-positive button-block">SAVE</button>
                </form>
              </div>
              <!--TAB: CHARTS -->

              <div class="dashboard-container dashboard-border dashboard-round-border list"
                    style="margin-top: 30px;">
                <div class="row">
                  <div class="col col-80" >
                    <h2><strong>Charts</strong></h2>
                  </div>
                  <div class="col">
                      <div class="row" style="float:right">
                        <button class="button button-large button-icon icon ion-android-add-circle"
                              style="float:right; color:#3C5A99"
                              class="col"
                              ng-click="addChart(activeTab)"></button>
                        <button id="addGateway-button55"
                            ng-click="compare()"
                            ng-show="activeTab == 1 && sensorsView.length != 0"
                            class="col"
                            style="float:right; background-color: #3C5A99; color: white"
                            class="button button-positive button-block button-large">Compare</button>
                      </div>
                  </div>
                </div>

                <!--TAB: GATEWAY AND SENSORS-->
                <form id="gateways-form54" class="list" style="margin-bottom: 100px;">
                  <div class="tabs-striped tabs-top tabs-background-positive tabs-color-light">
                    <div class="tabs" style="top: 0px;">
                      <a class="tab-item active"
                         ng-click="changeActiveTab(0)"
                         ng-class="{'active': activeTab==0}">
                        Gateways
                      </a>
                      <a class="tab-item"
                         ng-click="changeActiveTab(1)"
                         ng-class="{'active': activeTab==1}">
                        Sensors
                      </a>
                      <a class="tab-item"
                         ng-click="changeActiveTab(2)"
                         ng-class="{'active': activeTab==2}">
                        Actuators
                      </a>
                    </div>
                  </div>
                </form>

                <!--TAB: GATEWAY-->
                <div  ng-if="activeTab==0">
                  <div ng-show="chartsGatewaysView.length == 0" style="width: 100%">
                    <h4 style="text-align: center;">No Gateway attributes selected to display</h4>
                  </div>
                  <div class="card"
                       style="padding: 20px;"
                       ng-repeat="chart in chartsGatewaysView"
                       ng-show="chartsGatewaysView.length != 0">
                      <div class="column">
                        <div class="dashboard-item-main-column" style="width=80%">
                          <b>{{dashboard.name}}</b>
                          <p> Gateway Name: <strong>{{chart.deviceName}}</strong></p>
                          <p> Gateway UUID: #<strong>{{chart.deviceUUID}}</strong></p>
                          <p> Attribute: <strong>{{chart.attribute.name}}</strong></p>
                          <select style="float: left;"
                                  ng-show="chart.attribute.filters != 0"
                                  ng-model="chart.currentSelectFilter"
                                  ng-change="selectFilter(chart.id, chart.attribute.id, chart.currentSelectFilter.id)"
                                  ng-options="filter.name for filter in chart.attribute.filters">
                                    <option value="{{filter.id}}">{{filter.name}}</option>
                          </select>
                        </div>

                        <div class="dashboard-item-action-column"  style="width=20%; float: right;">
                            <button ng-click="deleteChartGateway(chart.id)"
                                    style="font-weight:600; float: right;"
                                    ng-style="{'color': dashboard.color}"
                                    class="button button-positive button-large button-block button-clear icon-right ion-android-close">
                            </button>
                        </div>
                        <div class="chart-container">
                           <canvas class="chart chart-pie"
                                ng-show="chart.typeId==0"
                                chart-data="chart.selectedDataset.data"
                                chart-labels="chart.selectedDataset.labels"
                                chart-colors="sensors_datachart_colors_options"
                                chart-options="sensors_datachart_piechart_sensors_statuses_options">
                          </canvas>
                          <canvas class="chart chart-doughnut"
                                ng-show="chart.typeId==1"
                                chart-data="chart.selectedDataset.data"
                                chart-labels="chart.selectedDataset.labels"
                                chart-colors="sensors_datachart_colors_options_ex"
                                chart-options="sensors_datachart_piechart_sensors_statuses_options">
                          </canvas>
                        </div>
                      </div>
                  </div>
                </div>

                <!--TAB: SENSORS-->
                <div ng-if="activeTab==1">
                    <div ng-show="sensorsView.length == 0" style="width: 100%">
                      <h4 style="text-align: center;">No sensors attributes selected to display</h4>
                    </div>
                    <div ng-show="sensorsView.length != 0">
                       <div class="row">
                         <h3 class="col">Realtime</h3>
                         <label class="toggle col-90">
                            <input type="checkbox" ng-model="isRealTime" ng-change="toggelRealTime()">
                            <div class="track">
                              <div class="handle"></div>
                            </div>
                          </label>
                      </div>

                      <div ng-repeat="(sensorClass, charts) in groupChartsSensorView">
                         <div class="card"
                          style="padding: 20px;"
                          ng-repeat="chart in charts">
                          <div class="column">
                            <div class="row">
                              <div class="col" style="width=80%">

                                <!--Chart Information-->
                                <div>
                                  <h4><strong>{{chart.device.name}}</strong></h4>
                                  <p style="color: grey"> LDSU UUID: {{chart.device.source}}</p>
                                  <p style="color: grey"> Number: {{chart.device.number}}</p>
                                  <p style="color: grey"> Gateway Name: {{chart.device.gatewayName}} </p>
                                  <p style="color: grey"> Gateway UUID: {{chart.device.gatewayUUID}}</p>
                                </div>

                                <!--Chart Low high-->
                                <div class="row" style="padding:5px;">
                                  <h3 class="col-50">{{chart.readings.value}} {{chart.device.unit}}</h3>
                                  <div class="col" style="float:right;">
                                    <p>Low: {{chart.readings.lowest}}</p>
                                    <p>High: {{chart.readings.highest}}</p>
                                  </div>
                                </div>

                              </div>
                              <div class="col"  style="width=20%; float: right;">
                                  <button ng-click="deleteChartSensor(chart.id)"
                                          style="font-weight:600; float: right;"
                                          ng-style="{'color': dashboard.color}"
                                          class="button button-positive button-large button-block button-clear icon-right ion-android-close">
                                  </button>
                              </div>
                            </div>

                            <div class="chart-container">

                              <!--Select Time-->
                                <select style="float: right;"
                                        class="col"
                                        ng-model="chart.currentSelectTime"
                                        ng-change="updateGetChartSensorsUrl(chart.currentSelectTime.value, chart.id)"
                                        ng-options="filter.name for filter in chart.selectedTimes">
                                        <option value="{{filter.value}}">{{filter.name}}</option>
                                </select>
                              <div class="row">
                                  <!--Select Back -->
                                  <button ng-click="backToHistorical(chart, chart.currentTimespan)"
                                          ng-style="{'opacity': opacityOfHistoricalButton}"
                                          class="button button-positive button-block button-clear icon-left ion-android-arrow-dropleft widget_button_backward_forward col">
                                  </button>

                                  <!--Select Next -->
                                  <button ng-click="nextToHistorical(chart, chart.currentTimespan)"
                                          ng-style="{'opacity': opacityOfHistoricalButton}"
                                          class="button button-positive button-block button-clear icon-right ion-android-arrow-dropright widget_button_backward_forward col">
                                  </button>
                              </div>
                              <canvas title="{{chart.device.name}}"
                                    class="chart chart-line"
                                    chart-colors="chart.colors"
                                    chart-data="chart.data"
                                    ng-show="chart.typeId==3"
                                    chart-labels="chart.labels"
                                    chart-options="chart.options"
                                    chart-dataset-override="chart.datasetOverride">
                              </canvas>

                              <canvas title="{{chart.device.name}}"
                                    class="chart chart-bar"
                                    chart-colors="chart.colors"
                                    chart-data="chart.data"
                                    ng-show="chart.typeId==2"
                                    chart-labels="chart.labels"
                                    chart-options="chart.options"
                                    chart-dataset-override="chart.datasetOverride">
                              </canvas>
                            </div>

                          </div>
                        </div>
                      </div>
                    </div>

                  </div>
                </div>

                <!-- TAB: Actuators-->
                <div  ng-if="activeTab==2">
                  <div style="width: 100%">
                    <h4 style="text-align: center;">No actuators attributes selected to display</h4>
                  </div>
                </div>
              </div>
        </div>
    </div>

  </ion-content>
</ion-view>
